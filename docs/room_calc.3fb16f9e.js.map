{"version":3,"sources":["Items/room_calc/room_calc.js"],"names":["declOfNum","n","titles","getParentElementByClassName","element","className","classList","contains","parentElement","update_table","calc","price","parseInt","attributes","value","service","addition","days","querySelector","selection_to","selection_from","isNaN","innerHTML","toLocaleString","innerText","room_calc__sub_total","querySelectorAll","room_calc__service_title","text","endsWith","window","room_calc__date_changed","addEventListener","tables","document","i","length"],"mappings":";AACA,SAASA,EAAUC,EAAGC,GACbA,OAAAA,EAAQD,EAAI,IAAO,GAAKA,EAAI,KAAQ,GAAM,EAAIA,EAAI,IAAM,GAAKA,EAAI,IAAM,IAAMA,EAAI,IAAM,IAAMA,EAAI,KAAO,IAAM,EAAI,GAI3H,SAASE,EAA4BC,EAASC,GACzC,GACED,GAAAA,EAAQE,UAAUC,SAASF,GAC5B,OAAOD,QACHA,EAAUA,EAAQI,eAQ5B,SAASC,EAAaC,GACpBA,EAAOP,EAA4BO,EAAM,oBACrCC,IAAAA,EAAQC,SAASF,EAAKG,WAAL,MAAyBC,OAC1CC,EAAUH,SAASF,EAAKG,WAAL,QAA2BC,OAC9CE,EAAWJ,SAASF,EAAKG,WAAL,SAA4BC,OAEhDG,EAAOP,EAAKQ,cAAc,wBAC9BD,GAAQA,EAAKE,aAAeF,EAAKG,gBAAmB,OACjDC,MAAMJ,IAAUA,EAAO,KACxBA,EAAO,GAEcP,EAAKQ,cAAc,qBACzBI,UAAY,MAAQX,EAAMY,iBAAmB,gBAExCb,EAAKQ,cAAc,oBACzBM,UAAYb,EAAMY,iBAAmB,MAAQN,EAAKM,iBAAmB,IAAMvB,EAAUiB,EAAM,CAAC,QAAQ,QAAQ,UAExHQ,IAAAA,EAAuBf,EAAKgB,iBAAiB,yBAG9CX,GAFHU,EAAqB,GAAGD,WAAab,EAAQM,GAAMM,iBAAmB,IAEnER,EAAU,EAAG,CACVY,IAAAA,EAA2BjB,EAAKQ,cAAc,6BAC9CU,EAAO,cAAgBb,GAASQ,iBAAmB,IACnDI,EAAyBH,UAAUK,SAASD,KAC9CD,EAAyBH,UAAYG,EAAyBH,UAAYI,GAE9EH,EAAqB,GAAGD,WAAcT,EAAU,EAAG,EAAEA,GAASQ,iBAAmB,IAEpDb,EAAKQ,cAAc,2BACzBM,WAAab,EAAQM,EAAOF,EAAUC,GAAUO,iBAAmB,IAjC5FO,OAAOC,wBAA0B,SAAS3B,GACxCK,EAAaL,IAmCf0B,OAAOE,iBAAiB,OAAQ,WAE1B,IADAC,IAAAA,EAASC,SAASR,iBAAiB,qBAC/BS,EAAE,EAAGA,EAAEF,EAAOG,OAAQD,IAC5B1B,EAAawB,EAAOE","file":"room_calc.3fb16f9e.js","sourceRoot":"..","sourcesContent":["/* Склонение declOfNum(count, ['найдена', 'найдено', 'найдены']); */\r\nfunction declOfNum(n, titles) {\r\n  return titles[(n % 10 === 1 && n % 100 !== 11) ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2];\r\n}\r\n\r\n/* Поиск родителя по названию класса */\r\nfunction getParentElementByClassName(element, className) {\r\n  do {\r\n    if(element.classList.contains(className))\r\n      return element;\r\n  } while(element = element.parentElement);\r\n}\r\n\r\n\r\nwindow.room_calc__date_changed = function(element) {\r\n  update_table(element);\r\n}\r\n\r\nfunction update_table(calc) {\r\n  calc = getParentElementByClassName(calc, 'room_calc__order');\r\n  var price = parseInt(calc.attributes['price'].value);\r\n  var service = parseInt(calc.attributes['service'].value);\r\n  var addition = parseInt(calc.attributes['addition'].value);\r\n\r\n  var days = calc.querySelector('.date_picker__filter');\r\n  days = (days.selection_to - days.selection_from) / (60*60*24*1000);\r\n  if(isNaN(days) || (days < 1))\r\n    days = 1;\r\n\r\n  var room_calc__price = calc.querySelector('.room_calc__price');\r\n  room_calc__price.innerHTML = '<b>' + price.toLocaleString() + '₽</b> в сутки';\r\n\r\n  var room_calc__days = calc.querySelector('.room_calc__days');\r\n  room_calc__days.innerText = price.toLocaleString() + ' х ' + days.toLocaleString() + ' ' + declOfNum(days, ['сутки','суток','суток']);\r\n\r\n  var room_calc__sub_total = calc.querySelectorAll('.room_calc__sub_total');\r\n  room_calc__sub_total[0].innerText = (price * days).toLocaleString() + '₽';\r\n\r\n  if(service < 0) {\r\n    var room_calc__service_title = calc.querySelector('.room_calc__service_title');\r\n    var text = ': скидка ' + (-service).toLocaleString() + '₽';\r\n    if(!room_calc__service_title.innerText.endsWith(text))\r\n      room_calc__service_title.innerText = room_calc__service_title.innerText + text;\r\n  }\r\n  room_calc__sub_total[1].innerText = ((service < 0)?0:service).toLocaleString() + '₽';\r\n\r\n  var room_calc__total_value = calc.querySelector('.room_calc__total_value');\r\n  room_calc__total_value.innerText = (price * days + service + addition).toLocaleString() + '₽';\r\n}\r\n\r\nwindow.addEventListener('load', function () {\r\n  var tables = document.querySelectorAll('.room_calc__order');\r\n  for(var i=0; i<tables.length; i++)\r\n    update_table(tables[i]);\r\n});"]}